program testloop

  implicit none

  integer, parameter :: nx_global = 360, ny_global = 320


  integer :: xoffset, yoffset, yoffset2
  integer :: isrc, jsrc,i,j

  xoffset = 1
  yoffset = 1

  do yoffset2=0,max(yoffset,0)-yoffset
     !jsrc = ny_global + yoffset + yoffset2 + (-ny_global + 1)
     do i=1,nx_global
        isrc = nx_global + xoffset - i
        if (isrc < 1) isrc = isrc + nx_global
        if (isrc > nx_global) isrc = isrc - nx_global
        print *,isrc
     end do
  end do

end program testloop
